<div class="overlay-backdrop" 
     [class.visible]="isVisible" 
     (click)="onBackdropClick($event)">
  
  <div class="overlay-popup" *ngIf="isVisible">
    <!-- Header -->
    <div class="overlay-header">
      <div class="header-logo">
        <div class="dioko-logo">
          <span class="logo-text">DIOKO</span>
        </div>
      </div>
      <div class="overlay-title">
        <ion-icon name="shield-checkmark-outline" class="overlay-icon"></ion-icon>
        Vérification d'identité
      </div>
      <button class="overlay-close" (click)="closeOverlay()">
        <ion-icon name="close-outline"></ion-icon>
      </button>
    </div>

    <!-- Content -->
    <div class="overlay-content">
      <div class="overlay-instructions">
        <p>Pour sécuriser votre compte, merci de fournir le <b>recto</b> et le <b>verso</b> de votre pièce d'identité, ainsi qu'un <b>selfie</b>.</p>
      </div>
      
      <div class="overlay-form">
        <!-- Carte d'identité (recto) -->
        <div class="upload-section">
          <div class="upload-header">
            <ion-icon name="card-outline" class="upload-icon"></ion-icon>
            <div class="upload-info">
              <h3 class="upload-title">CNI - Recto</h3>
              <p class="upload-subtitle">jpeg, png, jpg, pdf</p>
            </div>
          </div>
          <div class="upload-area" [class.has-file]="idCardFrontFile">
            <input type="file" accept=".jpeg,.jpg,.png,.pdf" (change)="onIdCardFrontChange($event)" class="file-input" id="overlay-id-card-front" />
            <label for="overlay-id-card-front" class="file-label">
              <ion-icon name="cloud-upload-outline" class="upload-cloud-icon"></ion-icon>
              <span class="upload-text" *ngIf="!idCardFrontFile">Choisir un fichier</span>
              <span class="upload-text selected" *ngIf="idCardFrontFile">{{ idCardFrontFile.name }}</span>
            </label>
          </div>
        </div>

        <!-- Carte d'identité (verso) -->
        <div class="upload-section">
          <div class="upload-header">
            <ion-icon name="card-outline" class="upload-icon"></ion-icon>
            <div class="upload-info">
              <h3 class="upload-title">CNI - Verso</h3>
              <p class="upload-subtitle">jpeg, png, jpg, pdf</p>
            </div>
          </div>
          <div class="upload-area" [class.has-file]="idCardBackFile">
            <input type="file" accept=".jpeg,.jpg,.png,.pdf" (change)="onIdCardBackChange($event)" class="file-input" id="overlay-id-card-back" />
            <label for="overlay-id-card-back" class="file-label">
              <ion-icon name="cloud-upload-outline" class="upload-cloud-icon"></ion-icon>
              <span class="upload-text" *ngIf="!idCardBackFile">Choisir un fichier</span>
              <span class="upload-text selected" *ngIf="idCardBackFile">{{ idCardBackFile.name }}</span>
            </label>
          </div>
        </div>

        <!-- Selfie -->
        <div class="upload-section">
          <div class="upload-header">
            <ion-icon name="person-circle-outline" class="upload-icon"></ion-icon>
            <div class="upload-info">
              <h3 class="upload-title">Photo selfie</h3>
              <p class="upload-subtitle">Selfie (jpeg, png, jpg)</p>
            </div>
          </div>
          <div class="upload-area" [class.has-file]="selfieFile">
            <input type="file" accept=".jpeg,.jpg,.png" (change)="onSelfieChange($event)" class="file-input" id="overlay-selfie" />
            <label for="overlay-selfie" class="file-label">
              <ion-icon name="cloud-upload-outline" class="upload-cloud-icon"></ion-icon>
              <span class="upload-text" *ngIf="!selfieFile">Choisir un fichier</span>
              <span class="upload-text selected" *ngIf="selfieFile">{{ selfieFile.name }}</span>
            </label>
          </div>
        </div>
        
        <!-- Messages -->
        <div *ngIf="errorMsg" class="overlay-error">
          <ion-icon name="alert-circle-outline" class="error-icon"></ion-icon>
          {{ errorMsg }}
        </div>
        <div *ngIf="successMsg" class="overlay-success">
          <ion-icon name="checkmark-circle-outline" class="success-icon"></ion-icon>
          {{ successMsg }}
        </div>
        
        <!-- Bouton de soumission -->
        <button 
          (click)="submit()" 
          [disabled]="loading || !idCardFrontFile || !idCardBackFile || !selfieFile" 
          class="overlay-submit">
          <ion-icon name="send-outline" *ngIf="!loading" class="submit-icon"></ion-icon>
          <span *ngIf="loading" class="loading-spinner">⟳</span>
          {{ loading ? 'Envoi en cours...' : 'Soumettre les documents' }}
        </button>
      </div>
    </div>
  </div>
</div> 